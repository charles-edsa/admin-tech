<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Painel Administrativo - Delivery</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * { font-family: 'Inter', sans-serif; }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Barra de Menu Superior -->
    <nav class="bg-white border-b border-gray-200 shadow-sm">
        <div class="max-w-7xl mx-auto px-2 sm:px-4 lg:px-8">
            <div class="flex justify-between items-center h-14 md:h-16">
                <h1 class="text-gray-800 text-lg md:text-xl font-semibold">
                    <i class="fas fa-store text-orange-500 mr-1 md:mr-2"></i>
                    <span class="hidden sm:inline">Painel Admin</span>
                    <span class="sm:hidden">Admin</span>
                </h1>
                
                <!-- Mobile Menu Button -->
                <button onclick="toggleMobileMenu()" class="md:hidden p-2 text-gray-600">
                    <i class="fas fa-bars text-lg"></i>
                </button>
                
                <!-- Desktop Navigation -->
                <div class="hidden md:block">
                    <nav class="flex space-x-8">
                        <button onclick="switchTab('pedidos')" id="tab-pedidos" class="tab-button text-orange-600 py-2 px-1 text-sm font-medium flex items-center border-b-2 border-orange-500">
                            <i class="fas fa-clipboard-list mr-2"></i>Pedidos
                        </button>
                        <button onclick="switchTab('salao')" id="tab-salao" class="tab-button text-gray-500 hover:text-gray-700 py-2 px-1 text-sm font-medium flex items-center border-b-2 border-transparent hover:border-gray-300">
                            <i class="fas fa-utensils mr-2"></i>Salão
                        </button>
                        <button onclick="switchTab('kds')" id="tab-kds" class="tab-button text-gray-500 hover:text-gray-700 py-2 px-1 text-sm font-medium flex items-center border-b-2 border-transparent hover:border-gray-300">
                            <i class="fas fa-tv mr-2"></i>KDS
                        </button>
                        <button onclick="switchTab('entregas')" id="tab-entregas" class="tab-button text-gray-500 hover:text-gray-700 py-2 px-1 text-sm font-medium flex items-center border-b-2 border-transparent hover:border-gray-300">
                            <i class="fas fa-truck mr-2"></i>Entregas
                        </button>
                    </nav>
                </div>
            </div>
            
            <!-- Mobile Navigation -->
            <div id="mobile-menu" class="md:hidden hidden bg-white border-t border-gray-200 py-2">
                <div class="grid grid-cols-2 gap-2 px-2">
                    <button onclick="switchTab('pedidos'); toggleMobileMenu();" id="mobile-tab-pedidos" class="mobile-tab-button bg-orange-100 text-orange-700 p-3 rounded-lg text-sm font-medium flex flex-col items-center">
                        <i class="fas fa-clipboard-list text-lg mb-1"></i>
                        <span>Pedidos</span>
                    </button>
                    <button onclick="switchTab('salao'); toggleMobileMenu();" id="mobile-tab-salao" class="mobile-tab-button bg-gray-100 text-gray-600 p-3 rounded-lg text-sm font-medium flex flex-col items-center">
                        <i class="fas fa-utensils text-lg mb-1"></i>
                        <span>Salão</span>
                    </button>
                    <button onclick="switchTab('kds'); toggleMobileMenu();" id="mobile-tab-kds" class="mobile-tab-button bg-gray-100 text-gray-600 p-3 rounded-lg text-sm font-medium flex flex-col items-center">
                        <i class="fas fa-tv text-lg mb-1"></i>
                        <span>KDS</span>
                    </button>
                    <button onclick="switchTab('entregas'); toggleMobileMenu();" id="mobile-tab-entregas" class="mobile-tab-button bg-gray-100 text-gray-600 p-3 rounded-lg text-sm font-medium flex flex-col items-center">
                        <i class="fas fa-truck text-lg mb-1"></i>
                        <span>Entregas</span>
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Conteúdo Principal -->
    <div class="max-w-7xl mx-auto py-3 px-2 sm:py-6 sm:px-6 lg:px-8">

        <!-- Aba Pedidos -->
        <div id="content-pedidos" class="tab-content">
            <!-- Mobile Layout -->
            <div class="block md:hidden space-y-4">
                <div class="bg-white rounded-lg border border-gray-200 overflow-hidden shadow-sm">
                    <div class="bg-amber-50 border-b border-amber-200 px-3 py-3">
                        <div class="flex items-center justify-between">
                            <h3 class="text-sm font-semibold text-amber-700 uppercase tracking-wide">
                                <i class="fas fa-clock text-amber-500 mr-1"></i>Aguardando
                            </h3>
                            <span id="contador-aguardando-mobile" class="bg-amber-100 text-amber-700 text-xs font-medium px-2 py-1 rounded">0</span>
                        </div>
                    </div>
                    <div id="coluna-aguardando-mobile" class="p-3">
                        <div class="text-center py-6 text-gray-400">
                            <i class="fas fa-clock text-xl mb-2"></i>
                            <p class="text-sm">Carregando pedidos...</p>
                        </div>
                    </div>
                </div>

                <div class="bg-white rounded-lg border border-gray-200 overflow-hidden shadow-sm">
                    <div class="bg-green-50 border-b border-green-200 px-3 py-3">
                        <div class="flex items-center justify-between">
                            <h3 class="text-sm font-semibold text-green-700 uppercase tracking-wide">
                                <i class="fas fa-check-circle text-green-500 mr-1"></i>Prontos
                            </h3>
                            <span id="contador-prontos-mobile" class="bg-green-100 text-green-700 text-xs font-medium px-2 py-1 rounded">0</span>
                        </div>
                    </div>
                    <div id="coluna-prontos-mobile" class="p-3">
                        <div class="text-center py-6 text-gray-400">
                            <i class="fas fa-check-circle text-xl mb-2"></i>
                            <p class="text-sm">Carregando pedidos...</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Desktop Layout -->
            <div class="hidden md:block">
                <div class="bg-white rounded-lg border border-gray-200 overflow-hidden shadow-sm">
                    <div class="grid grid-cols-2 bg-gray-50 border-b border-gray-200">
                        <div class="px-6 py-4 border-r border-gray-200">
                            <div class="flex items-center justify-between">
                                <h3 class="text-sm font-semibold text-gray-700 uppercase tracking-wide">
                                    <i class="fas fa-clock text-amber-500 mr-2"></i>Aguardando
                                </h3>
                                <span id="contador-aguardando" class="bg-amber-100 text-amber-700 text-xs font-medium px-2 py-1 rounded">0</span>
                            </div>
                        </div>
                        <div class="px-6 py-4">
                            <div class="flex items-center justify-between">
                                <h3 class="text-sm font-semibold text-gray-700 uppercase tracking-wide">
                                    <i class="fas fa-check-circle text-green-500 mr-2"></i>Prontos
                                </h3>
                                <span id="contador-prontos" class="bg-green-100 text-green-700 text-xs font-medium px-2 py-1 rounded">0</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-2 min-h-96">
                        <div id="coluna-aguardando" class="border-r border-gray-200 bg-white">
                            <div class="p-6 text-center text-gray-400">
                                <i class="fas fa-clock text-2xl mb-2"></i>
                                <p class="text-sm">Carregando pedidos...</p>
                            </div>
                        </div>
                        <div id="coluna-prontos" class="bg-white">
                            <div class="p-6 text-center text-gray-400">
                                <i class="fas fa-check-circle text-2xl mb-2"></i>
                                <p class="text-sm">Carregando pedidos...</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Aba Salão -->
        <div id="content-salao" class="tab-content hidden">
            <!-- Header com alternância Mesas/Comandas -->
            <div class="bg-white rounded-lg border border-gray-200 shadow-sm mb-4">
                <div class="px-4 py-3 border-b border-gray-200">
                    <div class="flex justify-center">
                        <!-- Toggle Mesas/Comandas -->
                        <div class="flex bg-gray-100 rounded-lg p-1">
                            <button onclick="alternarVisaoSalao('mesas')" id="btn-mesas" class="px-4 py-2 text-sm font-medium rounded-md transition-all duration-200 bg-white text-gray-900 shadow-sm">
                                <i class="fas fa-th-large mr-2"></i>Mesas
                            </button>
                            <button onclick="alternarVisaoSalao('comandas')" id="btn-comandas" class="px-4 py-2 text-sm font-medium rounded-md transition-all duration-200 text-gray-600 hover:text-gray-900">
                                <i class="fas fa-receipt mr-2"></i>Comandas
                            </button>
                        </div>
                    </div>
                </div>
                

                
                <!-- Conteúdo das Mesas -->
                <div id="conteudo-mesas" class="p-4">
                    <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-4" id="grade-mesas">
                        <!-- Mesas serão renderizadas aqui -->
                    </div>
                </div>
                
                <!-- Conteúdo das Comandas -->
                <div id="conteudo-comandas" class="hidden">
                    <div class="divide-y divide-gray-200" id="lista-comandas">
                        <!-- Comandas serão renderizadas aqui -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Aba KDS -->
        <div id="content-kds" class="tab-content hidden">
            <!-- Mobile Layout -->
            <div class="block md:hidden space-y-4">
                <div class="bg-white rounded-lg border border-gray-200 overflow-hidden shadow-sm">
                    <div class="bg-orange-50 border-b border-orange-200 px-3 py-3">
                        <div class="flex items-center justify-between">
                            <h3 class="text-sm font-semibold text-orange-700 uppercase tracking-wide">
                                <i class="fas fa-bell text-orange-500 mr-1"></i>Novos Pedidos
                            </h3>
                            <span id="contador-novos-mobile" class="bg-orange-100 text-orange-700 text-xs font-medium px-2 py-1 rounded">0</span>
                        </div>
                    </div>
                    <div id="coluna-novos-mobile" class="p-3">
                        <div class="text-center py-6 text-gray-400">
                            <i class="fas fa-bell text-xl mb-2"></i>
                            <p class="text-sm">Carregando pedidos...</p>
                        </div>
                    </div>
                </div>

                <div class="bg-white rounded-lg border border-gray-200 overflow-hidden shadow-sm">
                    <div class="bg-blue-50 border-b border-blue-200 px-3 py-3">
                        <div class="flex items-center justify-between">
                            <h3 class="text-sm font-semibold text-blue-700 uppercase tracking-wide">
                                <i class="fas fa-utensils text-blue-500 mr-1"></i>Em Preparação
                            </h3>
                            <span id="contador-preparo-mobile" class="bg-blue-100 text-blue-700 text-xs font-medium px-2 py-1 rounded">0</span>
                        </div>
                    </div>
                    <div id="coluna-preparo-mobile" class="p-3">
                        <div class="text-center py-6 text-gray-400">
                            <i class="fas fa-utensils text-xl mb-2"></i>
                            <p class="text-sm">Carregando pedidos...</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Desktop Layout -->
            <div class="hidden md:block">
                <div class="bg-white rounded-lg border border-gray-200 overflow-hidden shadow-sm">
                    <div class="grid grid-cols-2 bg-gray-50 border-b border-gray-200">
                        <div class="px-6 py-4 border-r border-gray-200">
                            <div class="flex items-center justify-between">
                                <h3 class="text-sm font-semibold text-gray-700 uppercase tracking-wide">
                                    <i class="fas fa-bell text-orange-500 mr-2"></i>Novos Pedidos
                                </h3>
                                <span id="contador-novos" class="bg-orange-100 text-orange-700 text-xs font-medium px-2 py-1 rounded">0</span>
                            </div>
                        </div>
                        <div class="px-6 py-4">
                            <div class="flex items-center justify-between">
                                <h3 class="text-sm font-semibold text-gray-700 uppercase tracking-wide">
                                    <i class="fas fa-utensils text-blue-500 mr-2"></i>Em Preparação
                                </h3>
                                <span id="contador-preparo" class="bg-blue-100 text-blue-700 text-xs font-medium px-2 py-1 rounded">0</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-2 min-h-96">
                        <div id="coluna-novos" class="border-r border-gray-200 bg-white">
                            <div class="p-6 text-center text-gray-400">
                                <i class="fas fa-bell text-2xl mb-2"></i>
                                <p class="text-sm">Carregando pedidos...</p>
                            </div>
                        </div>
                        <div id="coluna-preparo" class="bg-white">
                            <div class="p-6 text-center text-gray-400">
                                <i class="fas fa-utensils text-2xl mb-2"></i>
                                <p class="text-sm">Carregando pedidos...</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Aba Entregas -->
        <div id="content-entregas" class="tab-content hidden">
            <!-- Mobile Layout -->
            <div class="block md:hidden space-y-4">
                <div class="bg-white rounded-lg border border-gray-200 overflow-hidden shadow-sm">
                    <div class="bg-amber-50 border-b border-amber-200 px-3 py-3">
                        <div class="flex items-center justify-between">
                            <h3 class="text-sm font-semibold text-amber-700 uppercase tracking-wide">
                                <i class="fas fa-clock text-amber-500 mr-1"></i>Pendentes
                            </h3>
                            <span id="contador-pendentes-mobile" class="bg-amber-100 text-amber-700 text-xs font-medium px-2 py-1 rounded">0</span>
                        </div>
                    </div>
                    <div id="coluna-pendentes-mobile" class="p-3">
                        <div class="text-center py-6 text-gray-400">
                            <i class="fas fa-clock text-xl mb-2"></i>
                            <p class="text-sm">Carregando entregas...</p>
                        </div>
                    </div>
                </div>

                <div class="bg-white rounded-lg border border-gray-200 overflow-hidden shadow-sm">
                    <div class="bg-blue-50 border-b border-blue-200 px-3 py-3">
                        <div class="flex items-center justify-between">
                            <h3 class="text-sm font-semibold text-blue-700 uppercase tracking-wide">
                                <i class="fas fa-truck text-blue-500 mr-1"></i>Em Rota
                            </h3>
                            <span id="contador-rota-mobile" class="bg-blue-100 text-blue-700 text-xs font-medium px-2 py-1 rounded">0</span>
                        </div>
                    </div>
                    <div id="coluna-rota-mobile" class="p-3">
                        <div class="text-center py-6 text-gray-400">
                            <i class="fas fa-truck text-xl mb-2"></i>
                            <p class="text-sm">Carregando entregas...</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Desktop Layout -->
            <div class="hidden md:block">
                <div class="bg-white rounded-lg border border-gray-200 overflow-hidden shadow-sm">
                    <div class="grid grid-cols-2 bg-gray-50 border-b border-gray-200">
                        <div class="px-6 py-4 border-r border-gray-200">
                            <div class="flex items-center justify-between">
                                <h3 class="text-sm font-semibold text-gray-700 uppercase tracking-wide">
                                    <i class="fas fa-clock text-amber-500 mr-2"></i>Pendentes
                                </h3>
                                <span id="contador-pendentes" class="bg-amber-100 text-amber-700 text-xs font-medium px-2 py-1 rounded">0</span>
                            </div>
                        </div>
                        <div class="px-6 py-4">
                            <div class="flex items-center justify-between">
                                <h3 class="text-sm font-semibold text-gray-700 uppercase tracking-wide">
                                    <i class="fas fa-truck text-blue-500 mr-2"></i>Em Rota
                                </h3>
                                <span id="contador-rota" class="bg-blue-100 text-blue-700 text-xs font-medium px-2 py-1 rounded">0</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-2 min-h-96">
                        <div id="coluna-pendentes" class="border-r border-gray-200 bg-white">
                            <div class="p-6 text-center text-gray-400">
                                <i class="fas fa-clock text-2xl mb-2"></i>
                                <p class="text-sm">Carregando entregas...</p>
                            </div>
                        </div>
                        <div id="coluna-rota" class="bg-white">
                            <div class="p-6 text-center text-gray-400">
                                <i class="fas fa-truck text-2xl mb-2"></i>
                                <p class="text-sm">Carregando entregas...</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Dados do sistema
        const pedidosData = {
            aguardando: [
                {
                    id: 'D001',
                    cliente: 'João Silva',
                    telefone: '5511999991234',
                    telefoneFormatado: '(11) 99999-1234',
                    total: 45.90,
                    formaPagamento: 'Pix',
                    statusPagamento: 'Pago',
                    itens: [
                        { nome: 'Hambúrguer Artesanal', quantidade: 2, observacoes: ['Pão brioche', 'Carne 180g', 'Sem cebola'] },
                        { nome: 'Batata Frita', quantidade: 1, observacoes: ['Tamanho grande', 'Com bacon'] },
                        { nome: 'Refrigerante', quantidade: 2, observacoes: ['Coca-Cola 350ml'] }
                    ],
                    tempo: '2min',
                    hora: '14:30',
                    tipo: 'delivery',
                    endereco: 'Rua das Flores, 123 - Centro',
                    distancia: '1.2 km'
                },
                {
                    id: 'D002',
                    cliente: 'Maria Santos',
                    telefone: '5511988885678',
                    telefoneFormatado: '(11) 98888-5678',
                    total: 32.50,
                    formaPagamento: 'Online',
                    statusPagamento: 'Pendente',
                    itens: [
                        { nome: 'Pizza Margherita', quantidade: 1, observacoes: ['Tamanho médio', 'Borda recheada'] },
                        { nome: 'Refrigerante', quantidade: 1, observacoes: ['Guaraná 350ml'] }
                    ],
                    tempo: '5min',
                    hora: '14:25',
                    tipo: 'delivery',
                    endereco: 'Av. Brasil, 456 - Vila Nova',
                    distancia: '2.1 km'
                }
            ],
            prontos: [
                {
                    id: 'D005',
                    cliente: 'Carlos Lima',
                    telefone: '5511955557890',
                    telefoneFormatado: '(11) 95555-7890',
                    total: 28.90,
                    formaPagamento: 'Dinheiro',
                    statusPagamento: 'Pendente',
                    itens: [
                        { nome: 'Sanduíche Natural', quantidade: 1, observacoes: ['Pão integral', 'Frango desfiado', 'Sem maionese'] },
                        { nome: 'Suco de Laranja', quantidade: 1, observacoes: ['300ml', 'Sem açúcar'] }
                    ],
                    tempo: '3min',
                    hora: '14:10',
                    tipo: 'delivery',
                    endereco: 'Rua Augusta, 789 - Consolação',
                    distancia: '0.8 km'
                }
            ],
            novos: [
                {
                    id: 'D003',
                    cliente: 'Ana Costa',
                    telefone: '5511977779012',
                    telefoneFormatado: '(11) 97777-9012',
                    total: 38.50,
                    formaPagamento: 'Maquininha',
                    statusPagamento: 'Pago',
                    itens: [
                        { nome: 'Pizza Calabresa', quantidade: 1, observacoes: ['Tamanho médio', 'Extra queijo', 'Cebola roxa'] },
                        { nome: 'Refrigerante', quantidade: 1, observacoes: ['Pepsi 350ml'] }
                    ],
                    tempo: '1min',
                    hora: '14:32',
                    tipo: 'delivery',
                    endereco: 'Rua Oscar Freire, 321 - Jardins',
                    distancia: '3.5 km'
                }
            ],
            preparo: [
                {
                    id: 'D004',
                    cliente: 'Pedro Oliveira',
                    telefone: '5511966663456',
                    telefoneFormatado: '(11) 96666-3456',
                    total: 52.00,
                    formaPagamento: 'Pix',
                    statusPagamento: 'Pago',
                    itens: [
                        { nome: 'Hambúrguer Gourmet', quantidade: 2, observacoes: ['Carne angus 200g', 'Queijo brie', 'Rúcula'] },
                        { nome: 'Onion Rings', quantidade: 1, observacoes: ['Porção grande', 'Molho barbecue'] },
                        { nome: 'Refrigerante', quantidade: 2, observacoes: ['Coca-Cola 350ml'] }
                    ],
                    tempo: '15min',
                    hora: '14:15',
                    tipo: 'delivery',
                    endereco: 'Rua da Consolação, 500 - Centro',
                    distancia: '1.8 km'
                }
            ],
            pendentes: [
                {
                    id: 'D006',
                    cliente: 'Fernanda Costa',
                    telefone: '5511944445555',
                    telefoneFormatado: '(11) 94444-5555',
                    total: 35.90,
                    formaPagamento: 'Online',
                    statusPagamento: 'Pago',
                    itens: [
                        { nome: 'Pizza Margherita', quantidade: 1, observacoes: ['Tamanho médio', 'Massa fina'] },
                        { nome: 'Refrigerante', quantidade: 1, observacoes: ['Sprite 350ml'] }
                    ],
                    endereco: 'Rua das Palmeiras, 456 - Vila Madalena',
                    distancia: '1.5 km',
                    entregador: 'Carlos Moto',
                    tempoDesignacao: '14:05',
                    status: 'pendente',
                    hora: '13:50'
                }
            ],
            rota: [
                {
                    id: 'D007',
                    cliente: 'Roberto Santos',
                    telefone: '5511911112222',
                    telefoneFormatado: '(11) 91111-2222',
                    total: 42.50,
                    formaPagamento: 'Dinheiro',
                    statusPagamento: 'Pendente',
                    itens: [
                        { nome: 'Pizza Calabresa', quantidade: 1, observacoes: ['Tamanho grande', 'Borda catupiry', 'Azeitona'] },
                        { nome: 'Refrigerante', quantidade: 1, observacoes: ['Fanta 350ml'] }
                    ],
                    endereco: 'Av. Paulista, 1000 - Bela Vista',
                    distancia: '2.1 km',
                    entregador: 'João Bike',
                    tempoSaida: '13:45',
                    previsaoEntrega: '14:15',
                    status: 'saindo',
                    hora: '13:30'
                }
            ]
        };

        const entregadoresData = {
            disponiveis: [
                { id: 1, nome: 'Carlos Moto', veiculo: 'Moto', status: 'disponivel', entregas: 0 },
                { id: 2, nome: 'João Bike', veiculo: 'Bicicleta', status: 'ocupado', entregas: 1 },
                { id: 3, nome: 'Ana Delivery', veiculo: 'Carro', status: 'disponivel', entregas: 2 },
                { id: 4, nome: 'Pedro Express', veiculo: 'Moto', status: 'disponivel', entregas: 0 }
            ]
        };

        const salaoData = {
            mesas: [
                { id: 1, numero: '01', capacidade: 2, status: 'livre', cliente: null, horario: null, total: 0 },
                { id: 2, numero: '02', capacidade: 4, status: 'ocupada', cliente: 'João Silva', horario: '14:30', total: 45.90 },
                { id: 3, numero: '03', capacidade: 2, status: 'reservada', cliente: 'Maria Santos', horario: '15:00', total: 0 },
                { id: 4, numero: '04', capacidade: 6, status: 'livre', cliente: null, horario: null, total: 0 },
                { id: 5, numero: '05', capacidade: 4, status: 'ocupada', cliente: 'Carlos Lima', horario: '14:15', total: 32.50 },
                { id: 6, numero: '06', capacidade: 2, status: 'livre', cliente: null, horario: null, total: 0 },
                { id: 7, numero: '07', capacidade: 8, status: 'reservada', cliente: 'Ana Costa', horario: '16:00', total: 0 },
                { id: 8, numero: '08', capacidade: 4, status: 'livre', cliente: null, horario: null, total: 0 },
                { id: 9, numero: '09', capacidade: 2, status: 'ocupada', cliente: 'Pedro Oliveira', horario: '13:45', total: 28.90 },
                { id: 10, numero: '10', capacidade: 4, status: 'livre', cliente: null, horario: null, total: 0 },
                { id: 11, numero: '11', capacidade: 2, status: 'livre', cliente: null, horario: null, total: 0 },
                { id: 12, numero: '12', capacidade: 6, status: 'livre', cliente: null, horario: null, total: 0 }
            ],
            comandas: [
                {
                    id: 'C001',
                    mesa: '02',
                    cliente: 'João Silva',
                    horario: '14:30',
                    itens: [
                        { nome: 'Hambúrguer Artesanal', quantidade: 2, preco: 18.90, observacoes: ['Pão brioche', 'Carne 180g'] },
                        { nome: 'Batata Frita', quantidade: 1, preco: 8.90, observacoes: ['Tamanho grande'] },
                        { nome: 'Refrigerante', quantidade: 2, preco: 4.50, observacoes: ['Coca-Cola 350ml'] }
                    ],
                    total: 45.90,
                    status: 'aberta'
                },
                {
                    id: 'C002',
                    mesa: '05',
                    cliente: 'Carlos Lima',
                    horario: '14:15',
                    itens: [
                        { nome: 'Pizza Margherita', quantidade: 1, preco: 24.90, observacoes: ['Tamanho médio'] },
                        { nome: 'Suco de Laranja', quantidade: 1, preco: 7.60, observacoes: ['300ml', 'Natural'] }
                    ],
                    total: 32.50,
                    status: 'aberta'
                },
                {
                    id: 'C003',
                    mesa: '09',
                    cliente: 'Pedro Oliveira',
                    horario: '13:45',
                    itens: [
                        { nome: 'Sanduíche Natural', quantidade: 1, preco: 15.90, observacoes: ['Pão integral', 'Frango'] },
                        { nome: 'Água', quantidade: 1, preco: 3.00, observacoes: ['500ml'] },
                        { nome: 'Sobremesa', quantidade: 1, preco: 10.00, observacoes: ['Pudim de leite'] }
                    ],
                    total: 28.90,
                    status: 'aberta'
                }
            ]
        };

        // Funções principais
        function toggleMobileMenu() {
            const mobileMenu = document.getElementById('mobile-menu');
            mobileMenu.classList.toggle('hidden');
        }

        function switchTab(tabName) {
            // Remover classes ativas
            document.querySelectorAll('.tab-button').forEach(btn => {
                btn.classList.remove('border-orange-500', 'text-orange-600');
                btn.classList.add('border-transparent', 'text-gray-500');
            });
            
            document.querySelectorAll('.mobile-tab-button').forEach(btn => {
                btn.classList.remove('bg-orange-100', 'text-orange-700');
                btn.classList.add('bg-gray-100', 'text-gray-600');
            });
            
            // Esconder conteúdos
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.add('hidden');
            });
            
            // Ativar aba selecionada
            const activeTab = document.getElementById(`tab-${tabName}`);
            if (activeTab) {
                activeTab.classList.add('border-orange-500', 'text-orange-600');
                activeTab.classList.remove('border-transparent', 'text-gray-500');
            }
            
            const activeMobileTab = document.getElementById(`mobile-tab-${tabName}`);
            if (activeMobileTab) {
                activeMobileTab.classList.add('bg-orange-100', 'text-orange-700');
                activeMobileTab.classList.remove('bg-gray-100', 'text-gray-600');
            }
            
            // Mostrar conteúdo
            document.getElementById(`content-${tabName}`).classList.remove('hidden');
            
            // Atualizar dados da aba
            atualizarAba(tabName);
        }

        function atualizarContadores() {
            // Pedidos
            document.getElementById('contador-aguardando').textContent = pedidosData.aguardando.length;
            document.getElementById('contador-prontos').textContent = pedidosData.prontos.length;
            document.getElementById('contador-aguardando-mobile').textContent = pedidosData.aguardando.length;
            document.getElementById('contador-prontos-mobile').textContent = pedidosData.prontos.length;

            // KDS
            document.getElementById('contador-novos').textContent = pedidosData.novos.length;
            document.getElementById('contador-preparo').textContent = pedidosData.preparo.length;
            document.getElementById('contador-novos-mobile').textContent = pedidosData.novos.length;
            document.getElementById('contador-preparo-mobile').textContent = pedidosData.preparo.length;

            // Entregas
            document.getElementById('contador-pendentes').textContent = pedidosData.pendentes.length;
            document.getElementById('contador-rota').textContent = pedidosData.rota.length;
            document.getElementById('contador-pendentes-mobile').textContent = pedidosData.pendentes.length;
            document.getElementById('contador-rota-mobile').textContent = pedidosData.rota.length;
        }

        function renderizarPedidos(pedidos, containerId, tipo) {
            const container = document.getElementById(containerId);
            if (!container) return;

            if (pedidos.length === 0) {
                const emptyMessages = {
                    'aguardando': 'Nenhum pedido aguardando',
                    'prontos': 'Nenhum pedido pronto',
                    'novos': 'Nenhum pedido novo',
                    'preparo': 'Nenhum pedido em preparo',
                    'pendentes': 'Nenhuma entrega pendente',
                    'rota': 'Nenhuma entrega em rota'
                };
                
                const icons = {
                    'aguardando': 'clock',
                    'prontos': 'check-circle',
                    'novos': 'bell',
                    'preparo': 'utensils',
                    'pendentes': 'clock',
                    'rota': 'truck'
                };

                container.innerHTML = `
                    <div class="p-6 text-center text-gray-400">
                        <i class="fas fa-${icons[tipo]} text-2xl mb-2"></i>
                        <p class="text-sm">${emptyMessages[tipo]}</p>
                    </div>
                `;
                return;
            }

            const buttonConfig = {
                'aguardando': { text: 'Aceitar', action: 'aceitarPedido', color: 'blue' },
                'prontos': { text: 'Despachar', action: 'despacharPedido', color: 'green' },
                'novos': { text: 'Preparar', action: 'prepararPedido', color: 'blue' },
                'preparo': { text: 'Finalizar', action: 'finalizarPedido', color: 'green' },
                'pendentes': { text: 'Coletar', action: 'coletarPedido', color: 'blue' },
                'rota': { text: 'Confirmar', action: 'confirmarEntrega', color: 'green' }
            };

            const config = buttonConfig[tipo];

            const pedidosHTML = pedidos.map((pedido, index) => `
                <div class="px-6 py-4 ${index > 0 ? 'border-t border-gray-200' : ''} hover:bg-gray-50 transition-colors">
                    <div class="space-y-3">
                        <div class="flex items-center justify-between">
                            <span class="text-sm font-semibold text-gray-900">#${pedido.id}</span>
                            <span class="text-xs px-2 py-1 rounded-full bg-blue-100 text-blue-700">
                                <i class="fas fa-motorcycle mr-1"></i>Delivery
                            </span>
                        </div>
                        
                        <div class="space-y-2">
                            <div class="flex items-center justify-between">
                                <span class="text-sm text-gray-600">Cliente:</span>
                                <span class="text-sm font-medium text-gray-900">${pedido.cliente}</span>
                            </div>
                            
                            <div class="flex items-center justify-between">
                                <span class="text-sm text-gray-600">Telefone:</span>
                                <a href="https://wa.me/${pedido.telefone}" target="_blank" class="text-sm text-blue-600 hover:text-blue-800 hover:underline flex items-center">
                                    <i class="fab fa-whatsapp mr-1"></i>${pedido.telefoneFormatado}
                                </a>
                            </div>
                        </div>
                        
                        <div class="border-t border-gray-200 pt-3">
                            <div class="space-y-2">
                                <div class="flex items-center justify-between">
                                    <span class="text-sm text-gray-600">Itens:</span>
                                    <span class="text-sm font-medium text-gray-900">${pedido.itens.reduce((total, item) => total + item.quantidade, 0)}</span>
                                </div>
                                
                                <div class="space-y-2">
                                    ${pedido.itens.map(item => `
                                        <div class="text-sm text-gray-900">
                                            <div class="font-medium">${item.quantidade}x ${item.nome}</div>
                                            ${item.observacoes && item.observacoes.length > 0 ? `
                                                <div class="text-xs text-gray-600 ml-2 mt-1">(${item.observacoes.join(', ')})</div>
                                            ` : ''}
                                        </div>
                                    `).join('')}
                                </div>
                            </div>
                        </div>
                        
                        <div class="border-t border-gray-200 pt-3 space-y-2">
                            ${pedido.endereco ? `
                                <div class="flex items-start justify-between">
                                    <span class="text-sm text-gray-600">Endereço:</span>
                                    <div class="text-right">
                                        <a href="https://maps.google.com/?q=${encodeURIComponent(pedido.endereco)}" target="_blank" class="text-sm text-blue-600 hover:text-blue-800 hover:underline flex items-center">
                                            <i class="fas fa-map-marker-alt mr-1"></i>${pedido.endereco} • ${pedido.distancia}
                                        </a>
                                    </div>
                                </div>
                            ` : ''}
                            
                            <div class="flex items-center justify-between">
                                <span class="text-sm text-gray-600">Horário:</span>
                                <div class="text-right">
                                    <div class="text-sm text-gray-700">${pedido.hora}${pedido.tempo ? ` • ${pedido.tempo}` : ''}</div>
                                </div>
                            </div>
                            
                            ${pedido.entregador ? `
                                <div class="flex items-center justify-between">
                                    <span class="text-sm text-gray-600">Entregador:</span>
                                    <span class="text-sm font-medium text-gray-900">${pedido.entregador}</span>
                                </div>
                            ` : ''}
                        </div>
                        
                        <div class="border-t border-gray-200 pt-3 space-y-3">
                            <div class="space-y-2">
                                <div class="flex items-center justify-between">
                                    <span class="text-sm text-gray-600">Forma de Pagamento:</span>
                                    <span class="text-sm font-medium text-gray-900">${pedido.formaPagamento}</span>
                                </div>
                                
                                <div class="flex items-center justify-between">
                                    <span class="text-sm text-gray-600">Status do Pagamento:</span>
                                    <span class="text-sm font-medium ${pedido.statusPagamento === 'Pago' ? 'text-green-600' : 'text-amber-600'}">${pedido.statusPagamento}</span>
                                </div>
                            </div>
                            
                            <div class="flex justify-between items-center">
                                <span class="text-lg font-bold text-gray-900">R$ ${pedido.total.toFixed(2)}</span>
                                <button onclick="${config.action}('${pedido.id}')" class="bg-${config.color}-500 text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-${config.color}-600 transition-colors">
                                    ${config.text}
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            `).join('');

            container.innerHTML = pedidosHTML;
        }

        function renderizarPedidosMobile(pedidos, containerId, tipo) {
            const container = document.getElementById(containerId);
            if (!container) return;

            if (pedidos.length === 0) {
                const emptyMessages = {
                    'aguardando': 'Nenhum pedido aguardando',
                    'prontos': 'Nenhum pedido pronto',
                    'novos': 'Nenhum pedido novo',
                    'preparo': 'Nenhum pedido em preparo',
                    'pendentes': 'Nenhuma entrega pendente',
                    'rota': 'Nenhuma entrega em rota'
                };
                
                const icons = {
                    'aguardando': 'clock',
                    'prontos': 'check-circle',
                    'novos': 'bell',
                    'preparo': 'utensils',
                    'pendentes': 'clock',
                    'rota': 'truck'
                };

                container.innerHTML = `
                    <div class="text-center py-6 text-gray-400">
                        <i class="fas fa-${icons[tipo]} text-xl mb-2"></i>
                        <p class="text-sm">${emptyMessages[tipo]}</p>
                    </div>
                `;
                return;
            }

            const buttonConfig = {
                'aguardando': { text: 'Aceitar', action: 'aceitarPedido', color: 'blue' },
                'prontos': { text: 'Despachar', action: 'despacharPedido', color: 'green' },
                'novos': { text: 'Preparar', action: 'prepararPedido', color: 'blue' },
                'preparo': { text: 'Finalizar', action: 'finalizarPedido', color: 'green' },
                'pendentes': { text: 'Coletar', action: 'coletarPedido', color: 'blue' },
                'rota': { text: 'Confirmar', action: 'confirmarEntrega', color: 'green' }
            };

            const config = buttonConfig[tipo];

            const pedidosHTML = pedidos.map((pedido, index) => `
                <div class="px-3 py-3 ${index > 0 ? 'border-t border-gray-200' : ''} hover:bg-gray-50 transition-colors">
                    <div class="space-y-2">
                        <div class="flex items-center justify-between">
                            <span class="text-sm font-semibold text-gray-900">#${pedido.id}</span>
                            <span class="text-xs px-2 py-1 rounded-full bg-blue-100 text-blue-700">
                                <i class="fas fa-motorcycle mr-1"></i>Delivery
                            </span>
                        </div>
                        
                        <div class="space-y-1">
                            <div class="flex items-center justify-between">
                                <span class="text-xs text-gray-600">Cliente:</span>
                                <span class="text-xs font-medium text-gray-900">${pedido.cliente}</span>
                            </div>
                        </div>
                        
                        <div class="border-t border-gray-200 pt-2">
                            <div class="flex items-center justify-between mb-1">
                                <span class="text-xs text-gray-600">Itens:</span>
                                <span class="text-xs font-medium text-gray-900">${pedido.itens.reduce((total, item) => total + item.quantidade, 0)}</span>
                            </div>
                            
                            <div class="space-y-1">
                                ${pedido.itens.slice(0, 2).map(item => `
                                    <div class="text-xs text-gray-900">
                                        <div class="font-medium">${item.quantidade}x ${item.nome}</div>
                                    </div>
                                `).join('')}
                                ${pedido.itens.length > 2 ? `<div class="text-xs text-gray-500">+${pedido.itens.length - 2} mais itens</div>` : ''}
                            </div>
                        </div>
                        
                        <div class="border-t border-gray-200 pt-2 space-y-2">
                            <div class="space-y-1">
                                <div class="flex items-center justify-between">
                                    <span class="text-xs text-gray-600">Forma de Pagamento:</span>
                                    <span class="text-xs font-medium text-gray-900">${pedido.formaPagamento}</span>
                                </div>
                                
                                <div class="flex items-center justify-between">
                                    <span class="text-xs text-gray-600">Status do Pagamento:</span>
                                    <span class="text-xs font-medium ${pedido.statusPagamento === 'Pago' ? 'text-green-600' : 'text-amber-600'}">${pedido.statusPagamento}</span>
                                </div>
                            </div>
                            
                            <div class="flex justify-between items-center">
                                <span class="text-sm font-bold text-gray-900">R$ ${pedido.total.toFixed(2)}</span>
                                <button onclick="${config.action}('${pedido.id}')" class="bg-${config.color}-500 text-white px-3 py-1 rounded text-xs font-medium hover:bg-${config.color}-600 transition-colors">
                                    ${config.text}
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            `).join('');

            container.innerHTML = pedidosHTML;
        }

        function atualizarAba(tabName) {
            if (tabName === 'pedidos') {
                renderizarPedidos(pedidosData.aguardando, 'coluna-aguardando', 'aguardando');
                renderizarPedidos(pedidosData.prontos, 'coluna-prontos', 'prontos');
                renderizarPedidosMobile(pedidosData.aguardando, 'coluna-aguardando-mobile', 'aguardando');
                renderizarPedidosMobile(pedidosData.prontos, 'coluna-prontos-mobile', 'prontos');
                
            } else if (tabName === 'salao') {
                renderizarMesas();
                renderizarComandas();
                
            } else if (tabName === 'kds') {
                renderizarPedidos(pedidosData.novos, 'coluna-novos', 'novos');
                renderizarPedidos(pedidosData.preparo, 'coluna-preparo', 'preparo');
                renderizarPedidosMobile(pedidosData.novos, 'coluna-novos-mobile', 'novos');
                renderizarPedidosMobile(pedidosData.preparo, 'coluna-preparo-mobile', 'preparo');
                
            } else if (tabName === 'entregas') {
                renderizarPedidos(pedidosData.pendentes, 'coluna-pendentes', 'pendentes');
                renderizarPedidos(pedidosData.rota, 'coluna-rota', 'rota');
                renderizarPedidosMobile(pedidosData.pendentes, 'coluna-pendentes-mobile', 'pendentes');
                renderizarPedidosMobile(pedidosData.rota, 'coluna-rota-mobile', 'rota');
            }
            atualizarContadores();
        }

        // Funções do Salão
        function alternarVisaoSalao(visao) {
            // Atualizar botões
            const btnMesas = document.getElementById('btn-mesas');
            const btnComandas = document.getElementById('btn-comandas');
            const conteudoMesas = document.getElementById('conteudo-mesas');
            const conteudoComandas = document.getElementById('conteudo-comandas');

            if (visao === 'mesas') {
                // Ativar botão mesas
                btnMesas.className = 'px-4 py-2 text-sm font-medium rounded-md transition-all duration-200 bg-white text-gray-900 shadow-sm';
                btnComandas.className = 'px-4 py-2 text-sm font-medium rounded-md transition-all duration-200 text-gray-600 hover:text-gray-900';
                
                // Mostrar mesas
                conteudoMesas.classList.remove('hidden');
                conteudoComandas.classList.add('hidden');
                
            } else if (visao === 'comandas') {
                // Ativar botão comandas
                btnComandas.className = 'px-4 py-2 text-sm font-medium rounded-md transition-all duration-200 bg-white text-gray-900 shadow-sm';
                btnMesas.className = 'px-4 py-2 text-sm font-medium rounded-md transition-all duration-200 text-gray-600 hover:text-gray-900';
                
                // Mostrar comandas
                conteudoMesas.classList.add('hidden');
                conteudoComandas.classList.remove('hidden');
            }
        }

        function renderizarMesas() {
            const container = document.getElementById('grade-mesas');
            if (!container) return;

            const mesasHTML = salaoData.mesas.map(mesa => {
                const statusConfig = {
                    'livre': { bg: 'bg-white', border: 'border-gray-200', text: 'text-gray-700', statusColor: 'text-green-600', statusBg: 'bg-green-100', icon: 'check-circle' },
                    'ocupada': { bg: 'bg-white', border: 'border-gray-200', text: 'text-gray-700', statusColor: 'text-red-600', statusBg: 'bg-red-100', icon: 'user-friends' },
                    'reservada': { bg: 'bg-white', border: 'border-gray-200', text: 'text-gray-700', statusColor: 'text-amber-600', statusBg: 'bg-amber-100', icon: 'clock' }
                };

                const config = statusConfig[mesa.status];

                return `
                    <div onclick="abrirDetalheMesa(${mesa.id})" class="cursor-pointer transform hover:scale-105 transition-all duration-200">
                        <div class="aspect-square ${config.bg} ${config.border} border-2 rounded-xl p-4 flex flex-col items-center justify-center shadow-sm hover:shadow-md">
                            <div class="text-center w-full">
                                <div class="text-2xl font-bold ${config.text} mb-1">
                                    ${mesa.numero}
                                </div>
                                <div class="text-xs ${config.text} opacity-75 mb-3">
                                    <i class="fas fa-users mr-1"></i>${mesa.capacidade} pessoas
                                </div>
                                
                                <!-- Status Badge -->
                                <div class="flex items-center justify-center">
                                    <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${config.statusBg} ${config.statusColor}">
                                        <i class="fas fa-${config.icon} mr-1" style="font-size: 10px;"></i>
                                        ${mesa.status.charAt(0).toUpperCase() + mesa.status.slice(1)}
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');

            container.innerHTML = mesasHTML;
        }

        function renderizarComandas() {
            const container = document.getElementById('lista-comandas');
            if (!container) return;

            if (salaoData.comandas.length === 0) {
                container.innerHTML = `
                    <div class="p-8 text-center text-gray-400">
                        <i class="fas fa-receipt text-2xl mb-2"></i>
                        <p class="text-sm">Nenhuma comanda aberta</p>
                    </div>
                `;
                return;
            }

            const comandasHTML = salaoData.comandas.map(comanda => `
                <div onclick="abrirDetalheComanda('${comanda.id}')" class="p-4 hover:bg-gray-50 cursor-pointer transition-colors">
                    <div class="flex items-center justify-between mb-3">
                        <div class="flex items-center space-x-3">
                            <div class="bg-orange-100 text-orange-700 px-3 py-1 rounded-full text-sm font-medium">
                                #${comanda.id}
                            </div>
                            <div class="text-sm text-gray-600">
                                Mesa ${comanda.mesa}
                            </div>
                        </div>
                        <div class="text-right">
                            <div class="text-lg font-bold text-gray-900">R$ ${comanda.total.toFixed(2)}</div>
                            <div class="text-xs text-gray-500">${comanda.horario}</div>
                        </div>
                    </div>
                    
                    <div class="mb-3">
                        <div class="text-sm font-medium text-gray-900 mb-1">${comanda.cliente}</div>
                        <div class="text-sm text-gray-600">
                            ${comanda.itens.length} ${comanda.itens.length === 1 ? 'item' : 'itens'}
                        </div>
                    </div>
                    
                    <div class="space-y-1">
                        ${comanda.itens.slice(0, 2).map(item => `
                            <div class="text-sm text-gray-700">
                                <span class="font-medium">${item.quantidade}x</span> ${item.nome}
                                <span class="text-gray-500">- R$ ${(item.preco * item.quantidade).toFixed(2)}</span>
                            </div>
                        `).join('')}
                        ${comanda.itens.length > 2 ? `
                            <div class="text-sm text-gray-500">
                                +${comanda.itens.length - 2} mais ${comanda.itens.length - 2 === 1 ? 'item' : 'itens'}
                            </div>
                        ` : ''}
                    </div>
                    
                    <div class="mt-3 flex justify-end">
                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800">
                            <i class="fas fa-circle text-green-400 mr-1" style="font-size: 6px;"></i>
                            Aberta
                        </span>
                    </div>
                </div>
            `).join('');

            container.innerHTML = comandasHTML;
        }

        function abrirDetalheMesa(mesaId) {
            const mesa = salaoData.mesas.find(m => m.id === mesaId);
            if (!mesa) return;

            const overlay = document.createElement('div');
            overlay.className = 'fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4';
            
            const modal = document.createElement('div');
            modal.className = 'bg-white rounded-xl shadow-2xl w-full max-w-2xl max-h-[90vh] flex flex-col transform transition-all duration-300 scale-95 opacity-0';
            
            setTimeout(() => {
                modal.classList.remove('scale-95', 'opacity-0');
                modal.classList.add('scale-100', 'opacity-100');
            }, 10);
            
            const statusConfig = {
                'livre': { color: 'text-green-600', bg: 'bg-green-100', icon: 'check-circle', label: 'Livre' },
                'ocupada': { color: 'text-red-600', bg: 'bg-red-100', icon: 'user-friends', label: 'Ocupada' },
                'reservada': { color: 'text-amber-600', bg: 'bg-amber-100', icon: 'clock', label: 'Reservada' }
            };
            
            const config = statusConfig[mesa.status];
            
            const modalHTML = `
                <!-- Cabeçalho do Modal -->
                <div class="bg-white px-6 py-3 border-b border-gray-200 flex-shrink-0">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="text-lg font-semibold text-gray-900">Mesa ${mesa.numero}</h3>
                        </div>
                        <button onclick="fecharModalMesa()" class="text-gray-400 hover:text-gray-600 transition-colors p-1 rounded-lg hover:bg-gray-100">
                            <i class="fas fa-times text-lg"></i>
                        </button>
                    </div>
                </div>
                
                <!-- Conteúdo do Modal -->
                <div class="flex-1 overflow-y-auto">
                    ${mesa.status === 'livre' ? `
                        <!-- Mesa Livre -->
                        <div class="p-6">
                            <div class="text-center py-12">
                                <div class="w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4">
                                    <i class="fas fa-check-circle text-green-600 text-2xl"></i>
                                </div>
                                <h4 class="text-lg font-medium text-gray-900 mb-2">Mesa Disponível</h4>
                                <p class="text-gray-600 mb-6">Esta mesa está livre e pronta para receber clientes</p>
                                
                                <div class="flex space-x-3">
                                    <button onclick="ocuparMesa(${mesa.id})" class="flex-1 bg-blue-50 hover:bg-blue-100 text-blue-700 hover:text-blue-800 font-medium py-3 px-4 rounded-xl transition-all duration-200 border border-blue-200 hover:border-blue-300">
                                        <i class="fas fa-user-plus mr-2"></i>Ocupar Mesa
                                    </button>
                                    <button onclick="reservarMesa(${mesa.id})" class="flex-1 bg-amber-50 hover:bg-amber-100 text-amber-700 hover:text-amber-800 font-medium py-3 px-4 rounded-xl transition-all duration-200 border border-amber-200 hover:border-amber-300">
                                        <i class="fas fa-calendar-plus mr-2"></i>Fazer Reserva
                                    </button>
                                </div>
                            </div>
                        </div>
                    ` : mesa.status === 'reservada' ? `
                        <!-- Mesa Reservada -->
                        <div class="p-6">
                            <div class="text-center py-12">
                                <div class="w-16 h-16 bg-amber-100 rounded-full flex items-center justify-center mx-auto mb-4">
                                    <i class="fas fa-clock text-amber-600 text-2xl"></i>
                                </div>
                                <h4 class="text-lg font-medium text-gray-900 mb-2">Mesa Reservada</h4>
                                <p class="text-gray-600 mb-6">Reservada para <strong>${mesa.cliente}</strong> às ${mesa.horario}</p>
                                
                                <div class="flex space-x-3">
                                    <button onclick="confirmarChegada(${mesa.id})" class="flex-1 bg-green-50 hover:bg-green-100 text-green-700 hover:text-green-800 font-medium py-3 px-4 rounded-xl transition-all duration-200 border border-green-200 hover:border-green-300">
                                        <i class="fas fa-check mr-2"></i>Confirmar Chegada
                                    </button>
                                    <button onclick="cancelarReserva(${mesa.id})" class="flex-1 bg-red-50 hover:bg-red-100 text-red-700 hover:text-red-800 font-medium py-3 px-4 rounded-xl transition-all duration-200 border border-red-200 hover:border-red-300">
                                        <i class="fas fa-times mr-2"></i>Cancelar Reserva
                                    </button>
                                </div>
                            </div>
                        </div>
                    ` : `
                        <!-- Mesa Ocupada -->
                        <div class="p-6 space-y-6">
                            <!-- Informações da Mesa -->
                            <div class="flex items-center justify-between pb-4 border-b border-gray-200">
                                <div class="text-sm font-medium text-gray-900">Carlos Silva</div>
                                <div class="text-sm text-gray-600">${mesa.horario} • <span id="duracao-mesa">45 min</span></div>
                            </div>

                            <!-- Clientes e Pedidos Pendentes -->
                            <div id="lista-clientes">
                                ${renderizarClientesMesa()}
                            </div>

                            <!-- Botões Adicionar Cliente e Lançar Pedido -->
                            <div class="pt-4 border-t border-gray-200">
                                <div class="flex space-x-3 mb-4">
                                    <button onclick="adicionarCliente(${mesa.id})" class="flex-1 bg-gray-50 hover:bg-gray-100 border border-gray-200 hover:border-gray-300 rounded-lg p-4 text-sm font-medium text-gray-700 hover:text-gray-900 transition-all duration-200 flex items-center justify-center">
                                        <i class="fas fa-user-plus mr-2 text-gray-500"></i>Adicionar Cliente
                                    </button>
                                    <button onclick="lancarPedido(${mesa.id})" class="flex-1 bg-blue-50 hover:bg-blue-100 border border-blue-200 hover:border-blue-300 rounded-lg p-4 text-sm font-medium text-blue-700 hover:text-blue-800 transition-all duration-200 flex items-center justify-center">
                                        <i class="fas fa-plus mr-2 text-blue-500"></i>Lançar Pedido
                                    </button>
                                </div>

                                <!-- Container para formulário de adicionar cliente -->
                                <div id="container-form-cliente"></div>
                            </div>

                            <!-- Total da Mesa -->
                            <div class="pt-4 border-t border-gray-200">
                                <!-- Sublegenda Taxa de Serviço -->
                                <div id="sublegenda-taxa" class="flex justify-between items-center text-sm text-gray-600 mb-2">
                                    <span>Taxa de serviço:</span>
                                    <span id="valor-taxa-total">R$ 3,29</span>
                                </div>
                                
                                <div class="flex justify-between items-center mb-6">
                                    <span class="text-sm font-medium text-gray-700">Total da Mesa:</span>
                                    <span id="total-mesa" class="text-sm font-semibold text-orange-600">R$ 60,69</span>
                                </div>
                                
                                <!-- Botões de Ação -->
                                <div class="flex space-x-3">
                                    <button onclick="editarMesa(${mesa.id})" class="flex-1 bg-blue-50 hover:bg-blue-100 text-blue-700 hover:text-blue-800 font-medium py-3 px-4 rounded-lg transition-all duration-200 border border-blue-200 hover:border-blue-300 flex items-center justify-center">
                                        <i class="fas fa-edit mr-2"></i>Editar
                                    </button>
                                    <button onclick="imprimirConta(${mesa.id})" class="flex-1 bg-gray-50 hover:bg-gray-100 text-gray-700 hover:text-gray-800 font-medium py-3 px-4 rounded-lg transition-all duration-200 border border-gray-200 hover:border-gray-300 flex items-center justify-center">
                                        <i class="fas fa-print mr-2"></i>Imprimir
                                    </button>
                                    <button onclick="encerrarMesa(${mesa.id})" id="btn-encerrar-mesa" class="flex-1 ${verificarPagamentosCompletos() ? 'bg-red-50 hover:bg-red-100 text-red-700 hover:text-red-800' : 'bg-gray-100 text-gray-400 cursor-not-allowed'} font-medium py-3 px-4 rounded-lg transition-all duration-200 border ${verificarPagamentosCompletos() ? 'border-red-200 hover:border-red-300' : 'border-gray-200'} flex items-center justify-center" ${!verificarPagamentosCompletos() ? 'disabled' : ''}>
                                        <i class="fas fa-times mr-2"></i>Encerrar
                                    </button>
                                </div>
                            </div>
                        </div>
                    `}
                </div>
            `;
            
            modal.innerHTML = modalHTML;
            overlay.appendChild(modal);
            document.body.appendChild(overlay);
            
            window.modalMesaAberto = { overlay, modal };
            
            overlay.addEventListener('click', (e) => {
                if (e.target === overlay) {
                    fecharModalMesa();
                }
            });
        }

        function fecharModalMesa() {
            if (window.modalMesaAberto) {
                const { overlay, modal } = window.modalMesaAberto;
                
                modal.classList.remove('scale-100', 'opacity-100');
                modal.classList.add('scale-95', 'opacity-0');
                
                setTimeout(() => {
                    if (overlay && overlay.parentNode) {
                        overlay.remove();
                    }
                    window.modalMesaAberto = null;
                }, 300);
            }
        }

        function abrirDetalheComanda(comandaId) {
            const comanda = salaoData.comandas.find(c => c.id === comandaId);
            if (!comanda) return;

            console.log('Abrindo detalhes da comanda:', comanda);
            // Aqui você pode implementar um modal ou ação específica para a comanda
        }

        // Funções para gerenciamento de mesas
        function ocuparMesa(mesaId) {
            const mesa = salaoData.mesas.find(m => m.id === mesaId);
            if (mesa) {
                mesa.status = 'ocupada';
                mesa.cliente = 'Cliente Novo';
                mesa.horario = new Date().toLocaleTimeString('pt-BR', { hour: '2-digit', minute: '2-digit' });
                renderizarMesas();
                fecharModalMesa();
            }
        }

        function reservarMesa(mesaId) {
            const mesa = salaoData.mesas.find(m => m.id === mesaId);
            if (mesa) {
                mesa.status = 'reservada';
                mesa.cliente = 'Cliente Reserva';
                mesa.horario = '15:30';
                renderizarMesas();
                fecharModalMesa();
            }
        }

        function confirmarChegada(mesaId) {
            const mesa = salaoData.mesas.find(m => m.id === mesaId);
            if (mesa) {
                mesa.status = 'ocupada';
                mesa.horario = new Date().toLocaleTimeString('pt-BR', { hour: '2-digit', minute: '2-digit' });
                renderizarMesas();
                fecharModalMesa();
            }
        }

        function cancelarReserva(mesaId) {
            const mesa = salaoData.mesas.find(m => m.id === mesaId);
            if (mesa) {
                mesa.status = 'livre';
                mesa.cliente = null;
                mesa.horario = null;
                renderizarMesas();
                fecharModalMesa();
            }
        }

        function adicionarCliente(mesaId) {
            // Verificar se já existe um formulário ativo
            const formularioExistente = document.getElementById('form-adicionar-cliente');
            if (formularioExistente) {
                return; // Não criar outro formulário se já existe um
            }
            
            // Criar o formulário inline
            const formularioHTML = `
                <div id="form-adicionar-cliente" class="pb-4">
                    <div class="mb-4">
                        <input type="text" id="nome-cliente-inline" 
                               class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors text-sm"
                               placeholder="Digite o nome do cliente" required>
                    </div>
                    
                    <div class="flex space-x-3">
                        <button onclick="cancelarAdicionarCliente()" 
                                class="flex-1 bg-gray-100 hover:bg-gray-200 text-gray-700 font-medium py-2 px-3 rounded-lg transition-colors text-sm">
                            Cancelar
                        </button>
                        <button onclick="confirmarAdicionarCliente(${mesaId})" 
                                class="flex-1 bg-blue-500 hover:bg-blue-600 text-white font-medium py-2 px-3 rounded-lg transition-colors text-sm">
                            Confirmar
                        </button>
                    </div>
                </div>
            `;
            
            // Inserir o formulário no container específico
            const containerForm = document.getElementById('container-form-cliente');
            if (containerForm) {
                containerForm.innerHTML = formularioHTML;
                
                // Focar no input
                setTimeout(() => {
                    const input = document.getElementById('nome-cliente-inline');
                    if (input) input.focus();
                }, 100);
            }
        }

        function cancelarAdicionarCliente() {
            const containerForm = document.getElementById('container-form-cliente');
            if (containerForm) {
                containerForm.innerHTML = '';
            }
        }

        function confirmarAdicionarCliente(mesaId) {
            const nomeInput = document.getElementById('nome-cliente-inline');
            const nomeCliente = nomeInput ? nomeInput.value.trim() : '';
            
            if (nomeCliente) {
                // Adicionar o novo cliente aos dados da mesa
                const novoClienteId = `cliente${Date.now()}`;
                
                // Adicionar aos dados de taxas de serviço
                taxasServico[novoClienteId] = { 
                    ativo: false, 
                    subtotal: 0,
                    nome: nomeCliente,
                    itens: []
                };
                
                console.log(`Cliente "${nomeCliente}" adicionado à mesa ${mesaId}`);
                
                // Remover o formulário
                cancelarAdicionarCliente();
                
                // Atualizar a lista de clientes no modal existente
                const listaClientes = document.getElementById('lista-clientes');
                if (listaClientes) {
                    listaClientes.innerHTML = renderizarClientesMesa();
                    atualizarTotalMesa();
                }
            } else {
                alert('Por favor, digite o nome do cliente.');
            }
        }

        function lancarPedido(mesaId) {
            const overlay = document.createElement('div');
            overlay.className = 'fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4';
            
            const modal = document.createElement('div');
            modal.className = 'bg-white rounded-xl shadow-2xl w-full max-w-lg transform transition-all duration-300 scale-95 opacity-0';
            
            setTimeout(() => {
                modal.classList.remove('scale-95', 'opacity-0');
                modal.classList.add('scale-100', 'opacity-100');
            }, 10);
            
            // Lista de clientes disponíveis para a mesa
            const clientesDisponiveis = Object.keys(taxasServico).map(id => ({
                id,
                nome: taxasServico[id].nome
            }));
            
            modal.innerHTML = `
                <div class="p-6">
                    <div class="flex items-center justify-between mb-6">
                        <h3 class="text-lg font-semibold text-gray-900">Lançar Pedido</h3>
                        <button onclick="fecharModalLancarPedido()" class="text-gray-400 hover:text-gray-600 transition-colors p-1 rounded-lg hover:bg-gray-100">
                            <i class="fas fa-times text-lg"></i>
                        </button>
                    </div>
                    
                    <form onsubmit="confirmarLancamentoPedido(event, ${mesaId})" class="space-y-4">
                        <div>
                            <label for="cliente-pedido" class="block text-sm font-medium text-gray-700 mb-2">Cliente</label>
                            <select id="cliente-pedido" name="cliente-pedido" required 
                                    class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors">
                                <option value="">Selecione um cliente</option>
                                ${clientesDisponiveis.map(cliente => `
                                    <option value="${cliente.id}">${cliente.nome}</option>
                                `).join('')}
                            </select>
                        </div>
                        
                        <div>
                            <label for="item-nome" class="block text-sm font-medium text-gray-700 mb-2">Nome do Item</label>
                            <input type="text" id="item-nome" name="item-nome" required 
                                   class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors"
                                   placeholder="Ex: Hambúrguer Artesanal">
                        </div>
                        
                        <div class="grid grid-cols-2 gap-3">
                            <div>
                                <label for="item-quantidade" class="block text-sm font-medium text-gray-700 mb-2">Quantidade</label>
                                <input type="number" id="item-quantidade" name="item-quantidade" min="1" value="1" required 
                                       class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors">
                            </div>
                            <div>
                                <label for="item-preco" class="block text-sm font-medium text-gray-700 mb-2">Preço (R$)</label>
                                <input type="number" id="item-preco" name="item-preco" min="0" step="0.01" required 
                                       class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors"
                                       placeholder="0,00">
                            </div>
                        </div>
                        
                        <div>
                            <label for="item-observacoes" class="block text-sm font-medium text-gray-700 mb-2">Observações (opcional)</label>
                            <textarea id="item-observacoes" name="item-observacoes" rows="3"
                                      class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors"
                                      placeholder="Ex: Sem cebola, ponto da carne, molho à parte..."></textarea>
                        </div>
                        
                        <div class="flex space-x-3 pt-4">
                            <button type="button" onclick="fecharModalLancarPedido()" 
                                    class="flex-1 bg-gray-100 hover:bg-gray-200 text-gray-700 font-medium py-2 px-4 rounded-lg transition-colors">
                                Cancelar
                            </button>
                            <button type="submit" 
                                    class="flex-1 bg-blue-500 hover:bg-blue-600 text-white font-medium py-2 px-4 rounded-lg transition-colors">
                                Lançar Pedido
                            </button>
                        </div>
                    </form>
                </div>
            `;
            
            overlay.appendChild(modal);
            document.body.appendChild(overlay);
            
            window.modalLancarPedidoAberto = { overlay, modal };
            
            // Focar no select de cliente
            setTimeout(() => {
                const select = document.getElementById('cliente-pedido');
                if (select) select.focus();
            }, 100);
            
            overlay.addEventListener('click', (e) => {
                if (e.target === overlay) {
                    fecharModalLancarPedido();
                }
            });
        }

        function fecharModalLancarPedido() {
            if (window.modalLancarPedidoAberto) {
                const { overlay, modal } = window.modalLancarPedidoAberto;
                
                modal.classList.remove('scale-100', 'opacity-100');
                modal.classList.add('scale-95', 'opacity-0');
                
                setTimeout(() => {
                    if (overlay && overlay.parentNode) {
                        overlay.remove();
                    }
                    window.modalLancarPedidoAberto = null;
                }, 300);
            }
        }

        function confirmarLancamentoPedido(event, mesaId) {
            event.preventDefault();
            
            const clienteId = document.getElementById('cliente-pedido').value;
            const nomeItem = document.getElementById('item-nome').value.trim();
            const quantidade = parseInt(document.getElementById('item-quantidade').value);
            const preco = parseFloat(document.getElementById('item-preco').value);
            const observacoesText = document.getElementById('item-observacoes').value.trim();
            
            if (!clienteId || !nomeItem || !quantidade || !preco) {
                alert('Por favor, preencha todos os campos obrigatórios.');
                return;
            }
            
            const cliente = taxasServico[clienteId];
            if (!cliente) {
                alert('Cliente não encontrado.');
                return;
            }
            
            // Processar observações
            const observacoes = observacoesText ? observacoesText.split(',').map(obs => obs.trim()).filter(obs => obs) : [];
            
            // Criar novo item
            const novoItem = {
                nome: nomeItem,
                quantidade: quantidade,
                preco: preco,
                observacoes: observacoes
            };
            
            // Adicionar item ao cliente
            cliente.itens.push(novoItem);
            cliente.subtotal += preco * quantidade;
            
            console.log(`Pedido lançado para ${cliente.nome}: ${quantidade}x ${nomeItem} - R$ ${(preco * quantidade).toFixed(2)}`);
            
            fecharModalLancarPedido();
            
            // Atualizar a lista de clientes no modal da mesa
            const listaClientes = document.getElementById('lista-clientes');
            if (listaClientes) {
                listaClientes.innerHTML = renderizarClientesMesa();
                atualizarTotalMesa();
            }
        }

        function adicionarItem(mesaId) {
            console.log('Adicionando item à mesa:', mesaId);
            // Implementar modal para adicionar item
        }

        function fecharConta(mesaId) {
            const mesa = salaoData.mesas.find(m => m.id === mesaId);
            if (mesa) {
                mesa.status = 'livre';
                mesa.cliente = null;
                mesa.horario = null;
                mesa.total = 0;
                renderizarMesas();
                fecharModalMesa();
            }
        }

        function editarMesa(mesaId) {
            console.log('Editando mesa:', mesaId);
            // Implementar funcionalidade de edição
        }

        function imprimirConta(mesaId) {
            console.log('Imprimindo conta da mesa:', mesaId);
            // Implementar funcionalidade de impressão
        }

        function verificarPagamentosCompletos() {
            return Object.values(taxasServico).every(cliente => cliente.pagamento && cliente.pagamento.status === 'pago');
        }

        function atualizarBotaoEncerrar() {
            const btnEncerrar = document.getElementById('btn-encerrar-mesa');
            if (btnEncerrar) {
                const pagamentosCompletos = verificarPagamentosCompletos();
                
                if (pagamentosCompletos) {
                    btnEncerrar.className = 'flex-1 bg-red-50 hover:bg-red-100 text-red-700 hover:text-red-800 font-medium py-3 px-4 rounded-lg transition-all duration-200 border border-red-200 hover:border-red-300 flex items-center justify-center';
                    btnEncerrar.disabled = false;
                } else {
                    btnEncerrar.className = 'flex-1 bg-gray-100 text-gray-400 cursor-not-allowed font-medium py-3 px-4 rounded-lg transition-all duration-200 border border-gray-200 flex items-center justify-center';
                    btnEncerrar.disabled = true;
                }
            }
        }

        function encerrarMesa(mesaId) {
            if (!verificarPagamentosCompletos()) {
                alert('Todos os pagamentos devem ser confirmados antes de encerrar a mesa.');
                return;
            }
            
            const mesa = salaoData.mesas.find(m => m.id === mesaId);
            if (mesa) {
                mesa.status = 'livre';
                mesa.cliente = null;
                mesa.horario = null;
                mesa.total = 0;
                renderizarMesas();
                fecharModalMesa();
            }
        }

        // Funções de ação dos pedidos
        function aceitarPedido(id) {
            const pedidoIndex = pedidosData.aguardando.findIndex(p => p.id === id);
            if (pedidoIndex !== -1) {
                const pedido = pedidosData.aguardando.splice(pedidoIndex, 1)[0];
                pedidosData.novos.push(pedido);
                atualizarAba('pedidos');
            }
        }

        function prepararPedido(id) {
            const pedidoIndex = pedidosData.novos.findIndex(p => p.id === id);
            if (pedidoIndex !== -1) {
                const pedido = pedidosData.novos.splice(pedidoIndex, 1)[0];
                pedido.tempo = '15min';
                pedidosData.preparo.push(pedido);
                atualizarAba('kds');
            }
        }

        function finalizarPedido(id) {
            const pedidoIndex = pedidosData.preparo.findIndex(p => p.id === id);
            if (pedidoIndex !== -1) {
                const pedido = pedidosData.preparo.splice(pedidoIndex, 1)[0];
                pedido.tempo = '2min';
                pedidosData.prontos.push(pedido);
                atualizarAba('kds');
            }
        }

        function despacharPedido(id) {
            mostrarDropdownEntregadores(id);
        }

        function coletarPedido(id) {
            const pedidoIndex = pedidosData.pendentes.findIndex(p => p.id === id);
            if (pedidoIndex !== -1) {
                const pedido = pedidosData.pendentes.splice(pedidoIndex, 1)[0];
                pedido.tempoSaida = new Date().toLocaleTimeString('pt-BR', { hour: '2-digit', minute: '2-digit' });
                pedido.previsaoEntrega = new Date(Date.now() + 30*60000).toLocaleTimeString('pt-BR', { hour: '2-digit', minute: '2-digit' });
                pedido.status = 'saindo';
                pedidosData.rota.push(pedido);
                atualizarAba('entregas');
            }
        }

        function confirmarEntrega(id) {
            const pedidoIndex = pedidosData.rota.findIndex(p => p.id === id);
            if (pedidoIndex !== -1) {
                const pedido = pedidosData.rota.splice(pedidoIndex, 1)[0];
                
                // Liberar entregador
                const entregador = entregadoresData.disponiveis.find(e => e.nome === pedido.entregador);
                if (entregador) {
                    entregador.status = 'disponivel';
                }
                
                atualizarAba('entregas');
            }
        }

        // Sistema de seleção de entregadores
        function mostrarDropdownEntregadores(pedidoId) {
            const overlay = document.createElement('div');
            overlay.className = 'fixed inset-0 bg-black bg-opacity-50 z-40 flex items-end justify-center';
            
            const dropdown = document.createElement('div');
            dropdown.className = 'bg-white rounded-t-2xl shadow-2xl w-full max-w-md max-h-[80vh] overflow-hidden transform transition-all duration-300 translate-y-full';
            
            setTimeout(() => {
                dropdown.classList.remove('translate-y-full');
            }, 10);
            
            const entregadoresDisponiveis = entregadoresData.disponiveis.filter(e => e.status === 'disponivel');
            
            let dropdownHTML = `
                <div class="w-12 h-1 bg-gray-300 rounded-full mx-auto mt-3 mb-4"></div>
                
                <div class="px-4 sm:px-6 pb-4 border-b border-gray-200">
                    <div class="flex items-center justify-between">
                        <div>
                            <h4 class="text-lg font-semibold text-gray-800">Selecionar Entregador</h4>
                            <p class="text-sm text-gray-600 mt-1">Pedido #${pedidoId}</p>
                        </div>
                        <button onclick="fecharDropdown()" class="text-gray-400 hover:text-gray-600 transition-colors p-2">
                            <i class="fas fa-times text-xl"></i>
                        </button>
                    </div>
                </div>
                <div class="flex-1 overflow-y-auto">
            `;
            
            if (entregadoresDisponiveis.length === 0) {
                dropdownHTML += `
                    <div class="p-8 text-center text-gray-500">
                        <i class="fas fa-exclamation-triangle text-amber-500 text-2xl mb-3"></i>
                        <p class="text-base font-medium">Nenhum entregador disponível</p>
                        <p class="text-sm text-gray-400 mt-1">Todos os entregadores estão ocupados no momento</p>
                    </div>
                `;
            } else {
                entregadoresDisponiveis.forEach(entregador => {
                    const iconVeiculo = {
                        'Moto': 'motorcycle',
                        'Bicicleta': 'bicycle',
                        'Carro': 'car'
                    };
                    
                    dropdownHTML += `
                        <div onclick="selecionarEntregador('${pedidoId}', ${entregador.id})" 
                             class="p-4 sm:p-5 hover:bg-blue-50 cursor-pointer border-b border-gray-100 last:border-b-0 transition-all duration-200 active:bg-blue-100">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center space-x-4">
                                    <div class="w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0">
                                        <i class="fas fa-${iconVeiculo[entregador.veiculo]} text-blue-600 text-lg"></i>
                                    </div>
                                    <div class="min-w-0 flex-1">
                                        <p class="text-base font-medium text-gray-900 truncate">${entregador.nome}</p>
                                        <p class="text-sm text-gray-600">${entregador.veiculo}</p>
                                    </div>
                                </div>
                                <div class="text-right flex items-center space-x-3">
                                    <div>
                                        <p class="text-sm text-gray-500">${entregador.entregas} entregas hoje</p>
                                        <div class="flex items-center justify-end mt-1">
                                            <span class="inline-block w-2 h-2 bg-green-400 rounded-full mr-1"></span>
                                            <span class="text-xs text-green-600 font-medium">Disponível</span>
                                        </div>
                                    </div>
                                    <i class="fas fa-chevron-right text-gray-400"></i>
                                </div>
                            </div>
                        </div>
                    `;
                });
            }
            
            dropdownHTML += `
                </div>
                <div class="p-4 sm:p-6 border-t border-gray-200 bg-white">
                    <button onclick="fecharDropdown()" class="w-full bg-gray-200 hover:bg-gray-300 text-gray-700 font-medium py-3 px-4 rounded-lg transition-colors">
                        <i class="fas fa-times mr-2"></i>Cancelar
                    </button>
                </div>
            `;
            
            dropdown.innerHTML = dropdownHTML;
            overlay.appendChild(dropdown);
            document.body.appendChild(overlay);
            
            window.dropdownAberto = { overlay, dropdown };
            
            overlay.addEventListener('click', (e) => {
                if (e.target === overlay) {
                    fecharDropdown();
                }
            });
        }

        function selecionarEntregador(pedidoId, entregadorId) {
            const entregador = entregadoresData.disponiveis.find(e => e.id === entregadorId);
            if (!entregador) return;
            
            const pedidoIndex = pedidosData.prontos.findIndex(p => p.id === pedidoId);
            if (pedidoIndex !== -1) {
                const pedido = pedidosData.prontos.splice(pedidoIndex, 1)[0];
                
                pedido.entregador = entregador.nome;
                pedido.tempoDesignacao = new Date().toLocaleTimeString('pt-BR', { hour: '2-digit', minute: '2-digit' });
                pedido.status = 'pendente';
                
                entregador.status = 'ocupado';
                entregador.entregas += 1;
                
                pedidosData.pendentes.push(pedido);
                
                atualizarAba('pedidos');
            }
            
            fecharDropdown();
        }

        function fecharDropdown() {
            if (window.dropdownAberto) {
                const { overlay, dropdown } = window.dropdownAberto;
                
                dropdown.classList.add('translate-y-full');
                
                setTimeout(() => {
                    if (overlay && overlay.parentNode) {
                        overlay.remove();
                    }
                    window.dropdownAberto = null;
                }, 300);
            }
        }





        // Sistema de Taxa de Serviço
        const taxasServico = {
            cliente1: { 
                ativo: true, 
                subtotal: 32.90,
                nome: 'Carlos Silva',
                pagamento: null, // { forma: 'Pix', status: 'pago', valor: 36.19 }
                itens: [
                    { nome: 'Hambúrguer Artesanal', quantidade: 1, preco: 18.90, observacoes: ['Pão brioche', 'Carne 180g', 'Sem cebola'] },
                    { nome: 'Batata Frita Grande', quantidade: 1, preco: 9.50, observacoes: ['Com bacon e queijo'] },
                    { nome: 'Refrigerante', quantidade: 1, preco: 4.50, observacoes: ['Coca-Cola 350ml'] }
                ]
            },
            cliente2: { 
                ativo: false, 
                subtotal: 24.50,
                nome: 'Ana Silva',
                pagamento: null,
                itens: [
                    { nome: 'Pizza Individual Margherita', quantidade: 1, preco: 19.90, observacoes: ['Massa fina', 'Manjericão fresco'] },
                    { nome: 'Suco de Laranja', quantidade: 1, preco: 4.60, observacoes: ['Natural 300ml'] }
                ]
            }
        };

        // Pedidos Pendentes de Confirmação
        const pedidosPendentes = [
            {
                id: 'PP001',
                cliente: 'Carlos Silva',
                horarioLancamento: '14:45',
                status: 'em_preparo',
                total: 27.40,
                itens: [
                    { 
                        id: 'item_001',
                        nome: 'Lasanha Individual Tradicional', 
                        quantidade: 1, 
                        preco: 22.90,
                        observacoes: ['Extra queijo', 'Molho à parte'],
                        confirmado: false
                    },
                    { 
                        id: 'item_002',
                        nome: 'Coca-Cola 350ml', 
                        quantidade: 1, 
                        preco: 4.50,
                        observacoes: ['Gelado'],
                        confirmado: false
                    }
                ]
            },
            {
                id: 'PP002',
                cliente: 'Ana Silva',
                horarioLancamento: '14:50',
                status: 'em_preparo',
                total: 15.90,
                itens: [
                    { 
                        id: 'item_003',
                        nome: 'Salada Caesar Grande', 
                        quantidade: 1, 
                        preco: 15.90,
                        observacoes: ['Frango grelhado', 'Croutons', 'Parmesão extra', 'Molho à parte', 'Sem anchova'],
                        confirmado: false
                    }
                ]
            }
        ];

        function renderizarPedidosPendentes() {
            return pedidosPendentes;
        }

        function confirmarItem(pedidoId, itemId) {
            const pedido = pedidosPendentes.find(p => p.id === pedidoId);
            if (!pedido) return;
            
            const itemIndex = pedido.itens.findIndex(i => i.id === itemId);
            if (itemIndex === -1) return;
            
            const item = pedido.itens[itemIndex];
            
            // Adicionar o item ao cliente correspondente
            const clienteId = Object.keys(taxasServico).find(id => 
                taxasServico[id].nome === pedido.cliente
            );
            
            if (clienteId) {
                const cliente = taxasServico[clienteId];
                // Adicionar item confirmado aos itens do cliente
                const itemParaAdicionar = {
                    nome: item.nome,
                    quantidade: item.quantidade,
                    preco: item.preco,
                    observacoes: item.observacoes
                };
                cliente.itens.push(itemParaAdicionar);
                // Atualizar subtotal
                cliente.subtotal += item.preco * item.quantidade;
            }
            
            // Remover o item do pedido pendente
            pedido.itens.splice(itemIndex, 1);
            
            console.log(`Item ${item.nome} confirmado para ${pedido.cliente}`);
            
            // Se não há mais itens no pedido, remover o pedido da lista
            if (pedido.itens.length === 0) {
                const pedidoIndex = pedidosPendentes.findIndex(p => p.id === pedidoId);
                if (pedidoIndex !== -1) {
                    pedidosPendentes.splice(pedidoIndex, 1);
                    console.log(`Pedido ${pedidoId} totalmente confirmado e removido da lista de pendentes`);
                }
            }
            
            // Atualizar a interface
            const listaClientes = document.getElementById('lista-clientes');
            if (listaClientes) {
                listaClientes.innerHTML = renderizarClientesMesa();
            }
            
            atualizarTotalMesa();
        }

        function renderizarClientesMesa() {
            let html = '';
            let itemIndex = 0;
            
            // Renderizar clientes confirmados
            Object.keys(taxasServico).forEach((clienteId) => {
                const cliente = taxasServico[clienteId];
                const taxaValor = cliente.subtotal * 0.1;
                const totalComTaxa = cliente.ativo ? cliente.subtotal + taxaValor : cliente.subtotal;
                
                html += `
                    <div class="${itemIndex > 0 ? 'pt-4 ' : ''}pb-4 border-b border-gray-200">
                        <div class="mb-4 flex items-center justify-between">
                            <h4 class="text-sm font-semibold text-gray-900">${cliente.nome}</h4>
                            
                            <!-- Botão de Pagamento ao lado do nome -->
                            ${!cliente.pagamento ? `
                                <div class="relative">
                                    <button onclick="toggleDropdownPagamento('${clienteId}')" class="bg-amber-50 hover:bg-amber-100 text-amber-700 hover:text-amber-800 font-medium py-1 px-2 rounded text-xs flex items-center border border-amber-200 hover:border-amber-300 transition-all duration-200">
                                        <i class="fas fa-clock mr-1"></i>Pagamento pendente
                                        <i class="fas fa-chevron-down ml-1 text-xs"></i>
                                    </button>
                                    <div id="dropdown-${clienteId}" class="hidden absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 z-10">
                                        <div class="py-2">
                                            <button onclick="confirmarPagamento('${clienteId}', 'Pix')" class="w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 flex items-center">
                                                <i class="fas fa-qrcode mr-3 text-blue-500"></i>Pix
                                            </button>
                                            <button onclick="confirmarPagamento('${clienteId}', 'Online')" class="w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 flex items-center">
                                                <i class="fas fa-globe mr-3 text-green-500"></i>Online
                                            </button>
                                            <button onclick="confirmarPagamento('${clienteId}', 'Maquininha')" class="w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 flex items-center">
                                                <i class="fas fa-credit-card mr-3 text-purple-500"></i>Maquininha
                                            </button>
                                            <button onclick="confirmarPagamento('${clienteId}', 'Dinheiro')" class="w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 flex items-center">
                                                <i class="fas fa-money-bill-wave mr-3 text-orange-500"></i>Dinheiro
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            ` : `
                                <button onclick="removerPagamento('${clienteId}')" class="bg-green-50 hover:bg-green-100 text-green-700 hover:text-green-800 font-medium py-1 px-2 rounded text-xs flex items-center border border-green-200 hover:border-green-300 transition-all duration-200">
                                    <i class="fas fa-check mr-1"></i>Pagamento confirmado
                                </button>
                            `}
                        </div>
                        
                        <div class="space-y-3">
                            ${cliente.itens.map(item => `
                                <div class="flex items-start justify-between">
                                    <div class="flex-1">
                                        <div class="text-sm font-medium text-gray-900">${item.quantidade}x ${item.nome}</div>
                                        ${item.observacoes && item.observacoes.length > 0 ? `
                                            <div class="text-xs text-gray-600 mt-1">${item.observacoes.join(', ')}</div>
                                        ` : ''}
                                    </div>
                                    <div class="text-sm font-semibold text-gray-900">R$ ${(item.preco * item.quantidade).toFixed(2)}</div>
                                </div>
                            `).join('')}
                        </div>
                        
                        <!-- Taxa de Serviço -->
                        <div class="mt-4 pt-3">
                            <div class="flex items-center justify-between mb-2">
                                <span class="text-sm text-gray-600">Taxa de serviço (10%)</span>
                                <button onclick="toggleTaxaServico('${clienteId}')" id="toggle-${clienteId}" class="relative inline-flex h-5 w-9 items-center rounded-full ${cliente.ativo ? 'bg-blue-500' : 'bg-gray-300'} transition-colors focus:outline-none focus:ring-2 focus:ring-${cliente.ativo ? 'blue' : 'gray'}-500 focus:ring-offset-2">
                                    <span id="toggle-dot-${clienteId}" class="inline-block h-3 w-3 transform rounded-full bg-white transition-transform ${cliente.ativo ? 'translate-x-5' : 'translate-x-1'}"></span>
                                </button>
                            </div>
                            <div class="flex items-center justify-between mb-3">
                                <div class="text-sm text-gray-700">
                                    Subtotal: <span class="font-medium">R$ ${cliente.subtotal.toFixed(2)}</span><span class="text-xs text-gray-400 ml-2" id="taxa-${clienteId}" ${!cliente.ativo ? 'style="visibility: hidden;"' : ''}>+ R$ ${taxaValor.toFixed(2)}</span>
                                </div>
                                <div class="text-sm font-semibold text-orange-500" id="total-${clienteId}">R$ ${totalComTaxa.toFixed(2)}</div>
                            </div>
                        </div>
                    </div>
                `;
                itemIndex++;
            });
            
            // Renderizar pedidos pendentes
            pedidosPendentes.forEach((pedido) => {
                html += `
                    <div class="${itemIndex > 0 ? 'pt-4 ' : ''}pb-4 border-b border-gray-200">
                        <div class="mb-4">
                            <h4 class="text-sm font-semibold text-gray-900">${pedido.cliente}</h4>
                        </div>
                        
                        <div class="space-y-4">
                            ${pedido.itens.map(item => `
                                <div class="space-y-2">
                                    <!-- Linha 1: Nome do item e valor -->
                                    <div class="flex items-start justify-between">
                                        <div class="flex-1">
                                            <div class="text-sm font-medium text-gray-900">${item.quantidade}x ${item.nome}</div>
                                            ${item.observacoes && item.observacoes.length > 0 ? `
                                                <div class="text-xs text-gray-600 mt-1">${item.observacoes.join(', ')}</div>
                                            ` : ''}
                                        </div>
                                        <div class="flex flex-col items-end">
                                            <div class="text-sm font-semibold text-gray-900">R$ ${(item.preco * item.quantidade).toFixed(2)}</div>
                                            <span class="inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-amber-100 text-amber-700 mt-1">
                                                <i class="fas fa-utensils mr-1" style="font-size: 10px;"></i>
                                                Em preparo
                                            </span>
                                        </div>
                                    </div>
                                    
                                    <!-- Linha 2: Horário de lançamento e botão confirmar -->
                                    <div class="flex items-center justify-between">
                                        <div class="text-xs text-gray-600">
                                            Lançado às ${pedido.horarioLancamento}
                                        </div>
                                        <button onclick="confirmarItem('${pedido.id}', '${item.id}')" class="bg-green-50 hover:bg-green-100 text-green-700 hover:text-green-800 font-medium py-1.5 px-3 rounded text-xs flex items-center border border-green-200 hover:border-green-300 transition-all duration-200 min-w-[80px] justify-center">
                                            <i class="fas fa-check mr-1"></i>Confirmar
                                        </button>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
                itemIndex++;
            });
            
            // Remover a última borda se houver itens
            if (itemIndex > 0) {
                html = html.replace(/border-b border-gray-200(?!.*border-b border-gray-200)/s, '');
            }
            
            return html;
        }

        function toggleTaxaServico(clienteId) {
            const taxa = taxasServico[clienteId];
            if (!taxa) return;

            taxa.ativo = !taxa.ativo;
            
            const toggleButton = document.getElementById(`toggle-${clienteId}`);
            const toggleDot = document.getElementById(`toggle-dot-${clienteId}`);
            const taxaSpan = document.getElementById(`taxa-${clienteId}`);
            const totalSpan = document.getElementById(`total-${clienteId}`);
            
            if (taxa.ativo) {
                // Ativar taxa
                toggleButton.className = 'relative inline-flex h-5 w-9 items-center rounded-full bg-blue-500 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2';
                toggleDot.className = 'inline-block h-3 w-3 transform rounded-full bg-white transition-transform translate-x-5';
                
                const taxaValor = taxa.subtotal * 0.1;
                const totalComTaxa = taxa.subtotal + taxaValor;
                
                taxaSpan.style.visibility = 'visible';
                taxaSpan.className = 'text-xs text-gray-400 ml-2';
                taxaSpan.textContent = `+ R$ ${taxaValor.toFixed(2)}`;
                
                totalSpan.className = 'text-sm font-semibold text-orange-500';
                totalSpan.textContent = `R$ ${totalComTaxa.toFixed(2)}`;
            } else {
                // Desativar taxa
                toggleButton.className = 'relative inline-flex h-5 w-9 items-center rounded-full bg-gray-300 transition-colors focus:outline-none focus:ring-2 focus:ring-gray-300 focus:ring-offset-2';
                toggleDot.className = 'inline-block h-3 w-3 transform rounded-full bg-white transition-transform translate-x-1';
                
                taxaSpan.style.visibility = 'hidden';
                
                totalSpan.className = 'text-sm font-semibold text-orange-500';
                totalSpan.textContent = `R$ ${taxa.subtotal.toFixed(2)}`;
            }
            
            atualizarTotalMesa();
        }

        function atualizarTotalMesa() {
            let totalMesa = 0;
            let totalTaxa = 0;
            
            Object.values(taxasServico).forEach(taxa => {
                if (taxa.ativo) {
                    const taxaValor = taxa.subtotal * 0.1;
                    totalMesa += taxa.subtotal + taxaValor;
                    totalTaxa += taxaValor;
                } else {
                    totalMesa += taxa.subtotal;
                }
            });
            
            const totalElement = document.getElementById('total-mesa');
            const sublegendaElement = document.getElementById('sublegenda-taxa');
            const valorTaxaElement = document.getElementById('valor-taxa-total');
            
            if (totalElement) {
                totalElement.textContent = `R$ ${totalMesa.toFixed(2)}`;
            }
            
            // Mostrar/ocultar sublegenda da taxa
            if (sublegendaElement && valorTaxaElement) {
                if (totalTaxa > 0) {
                    sublegendaElement.style.display = 'flex';
                    valorTaxaElement.textContent = `R$ ${totalTaxa.toFixed(2)}`;
                } else {
                    sublegendaElement.style.display = 'none';
                }
            }
        }

        // Funções de Pagamento Individual
        function toggleDropdownPagamento(clienteId) {
            // Fechar outros dropdowns abertos
            document.querySelectorAll('[id^="dropdown-"]').forEach(dropdown => {
                if (dropdown.id !== `dropdown-${clienteId}`) {
                    dropdown.classList.add('hidden');
                }
            });
            
            const dropdown = document.getElementById(`dropdown-${clienteId}`);
            if (dropdown) {
                dropdown.classList.toggle('hidden');
            }
            
            // Fechar dropdown ao clicar fora
            if (!dropdown.classList.contains('hidden')) {
                setTimeout(() => {
                    document.addEventListener('click', function fecharDropdown(e) {
                        if (!e.target.closest(`#dropdown-${clienteId}`) && !e.target.closest(`button[onclick*="${clienteId}"]`)) {
                            dropdown.classList.add('hidden');
                            document.removeEventListener('click', fecharDropdown);
                        }
                    });
                }, 100);
            }
        }

        function confirmarPagamento(clienteId, formaPagamento) {
            const cliente = taxasServico[clienteId];
            if (!cliente) return;
            
            const taxaValor = cliente.subtotal * 0.1;
            const totalComTaxa = cliente.ativo ? cliente.subtotal + taxaValor : cliente.subtotal;
            
            // Registrar o pagamento como pago
            cliente.pagamento = {
                forma: formaPagamento,
                status: 'pago',
                valor: totalComTaxa,
                timestamp: new Date().toISOString()
            };
            
            console.log(`Pagamento confirmado para ${cliente.nome}: ${formaPagamento} - R$ ${totalComTaxa.toFixed(2)}`);
            
            // Fechar dropdown
            const dropdown = document.getElementById(`dropdown-${clienteId}`);
            if (dropdown) {
                dropdown.classList.add('hidden');
            }
            
            // Atualizar a interface
            const listaClientes = document.getElementById('lista-clientes');
            if (listaClientes) {
                listaClientes.innerHTML = renderizarClientesMesa();
                atualizarTotalMesa();
                atualizarBotaoEncerrar();
            }
        }

        function removerPagamento(clienteId) {
            const cliente = taxasServico[clienteId];
            if (cliente && cliente.pagamento) {
                cliente.pagamento = null;
                
                console.log(`Pagamento removido para ${cliente.nome}`);
                
                // Atualizar a interface
                const listaClientes = document.getElementById('lista-clientes');
                if (listaClientes) {
                    listaClientes.innerHTML = renderizarClientesMesa();
                    atualizarTotalMesa();
                    atualizarBotaoEncerrar();
                }
            }
        }

        // Função para calcular tempo de preparo
        function calcularTempoPreparo(horarioLancamento) {
            const agora = new Date();
            const [hora, minuto] = horarioLancamento.split(':').map(Number);
            
            const lancamento = new Date();
            lancamento.setHours(hora, minuto, 0, 0);
            
            // Se o horário de lançamento é maior que o atual, assumir que foi no dia anterior
            if (lancamento > agora) {
                lancamento.setDate(lancamento.getDate() - 1);
            }
            
            const diferenca = Math.floor((agora - lancamento) / (1000 * 60)); // diferença em minutos
            
            if (diferenca < 60) {
                return `${diferenca} min`;
            } else {
                const horas = Math.floor(diferenca / 60);
                const minutosRestantes = diferenca % 60;
                return `${horas}h ${minutosRestantes}min`;
            }
        }

        // Inicialização
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Sistema iniciando...');
            atualizarAba('pedidos');
            console.log('Sistema inicializado com sucesso!');
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'982a86c9c2f86508',t:'MTc1ODQ2NzgxNi4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
